{"ast":null,"code":"var _jsxFileName = \"/Users/shiyizhang/Desktop/214/s22-rec10/frontend/src/App.tsx\";\nimport Handlebars from \"handlebars\";\nimport { Component } from 'react';\nimport './App.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar oldHref = \"http://localhost:3000\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      template: this.loadTemplate(),\n      cells: [{\n        text: \"\",\n        clazz: \"\",\n        link: \"/play?x=0&y=0\"\n      }],\n      name: \"A Game Framework\",\n      footer: \"No game is running\",\n      plugins: [{\n        name: \"Load Games\",\n        link: \"/start\"\n      }],\n      numColStyle: \"auto\",\n      currentPlayer: \"\",\n      gameOverMsg: \"\"\n    };\n  }\n\n  loadTemplate() {\n    const src = document.getElementById(\"handlebars\");\n    return Handlebars.compile(src === null || src === void 0 ? void 0 : src.innerHTML, {});\n  }\n\n  convertToCell(p) {\n    const newCells = [];\n\n    for (var i = 0; i < p[\"cells\"].length; i++) {\n      var c = {\n        text: p[\"cells\"][i][\"text\"],\n        clazz: p[\"cells\"][i][\"clazz\"],\n        link: p[\"cells\"][i][\"link\"]\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  convertToPlugin(p) {\n    const newPlugins = [];\n\n    for (var i = 0; i < p[\"plugins\"].length; i++) {\n      var plug = {\n        name: p[\"plugins\"][i][\"name\"],\n        link: p[\"plugins\"][i][\"link\"]\n      };\n      newPlugins.push(plug);\n    }\n\n    return newPlugins;\n  }\n\n  async start() {\n    const href = \"start\";\n    const response = await fetch(href);\n    const json = await response.json();\n    const newPlugins = this.convertToPlugin(json);\n    this.setState({\n      plugins: newPlugins\n    });\n  }\n\n  async play(url) {\n    const href = \"play?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    const newCells = this.convertToCell(json);\n    const newPlugins = this.convertToPlugin(json);\n    this.setState({\n      cells: newCells,\n      plugins: newPlugins,\n      name: json[\"name\"],\n      footer: json[\"footer\"],\n      currentPlayer: json[\"currentPlayer\"],\n      numColStyle: json[\"numColStyle\"],\n      gameOverMsg: json[\"gameOverMsg\"]\n    });\n  }\n\n  async choosePlugin(url) {\n    const href = \"plugin?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n    const newCells = this.convertToCell(json);\n    const newPlugins = this.convertToPlugin(json);\n    this.setState({\n      cells: newCells,\n      plugins: newPlugins,\n      name: json[\"name\"],\n      footer: json[\"footer\"],\n      numColStyle: json[\"numColStyle\"],\n      currentPlayer: json[\"currentPlayer\"],\n      gameOverMsg: json[\"gameOverMsg\"]\n    });\n  }\n\n  async switch() {\n    if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/plugin\" && oldHref !== window.location.href) {\n      this.choosePlugin(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href.split(\"?\")[0] === \"http://localhost:3000/play\" && oldHref !== window.location.href) {\n      this.play(window.location.href);\n      oldHref = window.location.href;\n    } else if (window.location.href === \"http://localhost:3000/\" || window.location.href === \"http://localhost:3000/start\") {\n      this.start();\n      oldHref = window.location.href;\n    }\n  }\n\n  render() {\n    this.switch();\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        dangerouslySetInnerHTML: {\n          __html: this.state.template({\n            cells: this.state.cells,\n            name: this.state.name,\n            footer: this.state.footer,\n            plugins: this.state.plugins,\n            numColStyle: this.state.numColStyle,\n            gameOverMsg: this.state.gameOverMsg,\n            currentPlayer: this.state.currentPlayer\n          })\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\n;\nexport default App;","map":{"version":3,"sources":["/Users/shiyizhang/Desktop/214/s22-rec10/frontend/src/App.tsx"],"names":["Handlebars","Component","oldHref","App","constructor","props","state","template","loadTemplate","cells","text","clazz","link","name","footer","plugins","numColStyle","currentPlayer","gameOverMsg","src","document","getElementById","compile","innerHTML","convertToCell","p","newCells","i","length","c","push","convertToPlugin","newPlugins","plug","start","href","response","fetch","json","setState","play","url","split","choosePlugin","switch","window","location","render","__html"],"mappings":"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","sourcesContent":["import Handlebars from \"handlebars\"\nimport { Component } from 'react'\nimport './App.css'\n\nvar oldHref = \"http://localhost:3000\"\n\ninterface Cell {\n  text: String;\n  clazz: String;\n  link: String;\n}\n\n\ninterface Plugin {\n    name: String;\n    link: String;\n}\n\ninterface GameState {\n  name: String;\n  footer: String;\n  cells: Array<Cell>;\n  plugins: Array<Plugin>;\n  numColStyle: String;\n  currentPlayer: String;\n  gameOverMsg: String;\n  template: HandlebarsTemplateDelegate<any>;\n}\n\ninterface Props {\n}\n\nclass App extends Component<Props, GameState> {\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      template: this.loadTemplate(),\n      cells: [\n        { text: \"\", clazz: \"\", link: \"/play?x=0&y=0\" },\n      ],\n      name : \"A Game Framework\",\n      footer : \"No game is running\",\n      plugins : [\n      { name: \"Load Games\", link:\"/start\"},\n      ],\n      numColStyle : \"auto\",\n      currentPlayer : \"\",\n      gameOverMsg : \"\",\n    };\n  }\n\n  loadTemplate (): HandlebarsTemplateDelegate<any> {\n    const src = document.getElementById(\"handlebars\");\n    return Handlebars.compile(src?.innerHTML, {});\n  }\n\n  convertToCell(p: any): Array<Cell> {\n    const newCells: Array<Cell> = [];\n    for (var i = 0; i < p[\"cells\"].length; i++) {\n      var c: Cell = {\n        text: p[\"cells\"][i][\"text\"],\n        clazz: p[\"cells\"][i][\"clazz\"],\n        link: p[\"cells\"][i][\"link\"],\n      };\n      newCells.push(c);\n    }\n\n    return newCells;\n  }\n\n  convertToPlugin(p: any): Array<Plugin> {\n    const newPlugins: Array<Plugin> = [];\n    for (var i = 0; i < p[\"plugins\"].length; i++) {\n          var plug: Plugin = {\n            name: p[\"plugins\"][i][\"name\"],\n            link: p[\"plugins\"][i][\"link\"],\n          };\n          newPlugins.push(plug);\n        }\n\n        return newPlugins;\n  }\n\n\n  async start(){\n    const href = \"start\";\n    const response = await fetch(href);\n\n    const json = await response.json();\n    const newPlugins: Array<Plugin> = this.convertToPlugin(json);\n    this.setState({ plugins: newPlugins,})\n  }\n\n  async play(url: String) {\n    const href = \"play?\" + url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n\n    const newCells: Array<Cell> = this.convertToCell(json);\n    const newPlugins: Array<Plugin> = this.convertToPlugin(json);\n    this.setState({ cells: newCells, plugins: newPlugins, name: json[\"name\"],footer:json[\"footer\"], currentPlayer : json[\"currentPlayer\"],\n                                                                                numColStyle : json[\"numColStyle\"],\n                                                                                gameOverMsg : json[\"gameOverMsg\"] })\n  }\n\n  async choosePlugin(url: String){\n    const href = \"plugin?\"+url.split(\"?\")[1];\n    const response = await fetch(href);\n    const json = await response.json();\n\n    const newCells: Array<Cell> = this.convertToCell(json);\n    const newPlugins: Array<Plugin> = this.convertToPlugin(json);\n    this.setState({ cells: newCells, plugins: newPlugins, name: json[\"name\"],footer:json[\"footer\"],numColStyle : json[\"numColStyle\"],\n                                                                                currentPlayer : json[\"currentPlayer\"],\n                                                                                gameOverMsg : json[\"gameOverMsg\"] })\n  }\n\n\n  async switch() {\n    if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/plugin\" &&\n      oldHref !== window.location.href\n    ) {\n      this.choosePlugin(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n      window.location.href.split(\"?\")[0] === \"http://localhost:3000/play\" &&\n      oldHref !== window.location.href\n    ) {\n      this.play(window.location.href);\n      oldHref = window.location.href;\n    } else if (\n      window.location.href === \"http://localhost:3000/\" ||\n      window.location.href === \"http://localhost:3000/start\"\n    ){\n      this.start();\n      oldHref = window.location.href;\n    }\n  };\n\n  render() {\n    this.switch()\n    return (\n      <div className=\"App\">\n        <div\n          dangerouslySetInnerHTML={{\n            __html: this.state.template({ cells: this.state.cells, name: this.state.name, footer: this.state.footer,\n             plugins: this.state.plugins, numColStyle: this.state.numColStyle, gameOverMsg: this.state.gameOverMsg,\n              currentPlayer : this.state.currentPlayer}),\n          }}\n        />\n      </div>\n    )\n  };\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}